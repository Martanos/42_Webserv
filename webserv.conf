# ==================================================================
# CGI SHOWCASE CONFIGURATION FOR WEBSERV
# ==================================================================

# Configuration for the CGI showcase server running on localhost:3000
# This configuration serves static HTML/PHP files, handles CGI scripts,
# and supports file uploads with proper error handling.

server {
    # Server listening port
    listen 3000;

    # Server name (domain)
    server_name localhost;

    # Root directory for serving static files
    root /home/sean/projects/webserv/www/html;

    # Maximum client request body size (for uploads)
    client_max_body_size 10M;

    # Error page mappings
    error_page 400 /responses/400.php;
    error_page 403 /responses/403.php;
    error_page 404 /errors/404.html;
    error_page 500 /responses/500.php;

    # Static file location - serves HTML/JS/CSS etc.
    location / {
        # Allow GET requests for static files
        allowed_methods GET POST;
		# Default index files to look for
    	index index.php index.html;
		cgi_path /home/sean/projects/webserv/www/html;
    }

    location /upload {
        # Allow POST requests for file uploads
        allowed_methods POST;

        # CGI executable path for handling uploads
        cgi_path /home/sean/projects/webserv/www/html/upload.php;

        # CGI environment parameters (webserv handles most CGI vars automatically)
        # cgi_param REQUEST_METHOD POST;
        # cgi_param CONTENT_TYPE "";
        # cgi_param CONTENT_LENGTH 0;
    }
}

server {

    listen 4000;

    server_name static_sites.com;
    root /home/sean/projects/webserv/ww1/html;

    index index.html;

    # client_max_body_size 1;
    error_page 404 /error/404.html;
    error_page 500 /error/500.html;

    location / {
        allowed_methods GET POST;
    }
}
